{% extends "base.html" %}

{% block title %}APIæ–‡æ¡£ - NetSage{% endblock %}

{% block content %}
<div class="api-docs">
    <div class="api-sidebar">
        <div class="sidebar-header">
            <h3>API æ–‡æ¡£</h3>
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li><a href="#introduction" class="active">ç®€ä»‹</a></li>
                <li><a href="#authentication">è®¤è¯</a></li>
                <li><a href="#pricing">è®¡è´¹è¯´æ˜</a></li>
                <li>
                    <span class="nav-group">æ¥å£</span>
                    <ul>
                        <li><a href="#fetch-api">ç½‘é¡µå†…å®¹è·å– API</a></li>
                        <li><a href="#search-api">ç½‘ç»œæ£€ç´¢ API</a></li>
                        <li><a href="#crawl-api">æ™ºèƒ½çˆ¬å–æœç´¢ API</a></li>
                    </ul>
                </li>
                <li><a href="#playground">åœ¨çº¿æµ‹è¯•</a></li>
            </ul>
        </nav>
    </div>

    <div class="api-content">
        <section id="introduction" class="doc-section">
            <h1>NetSage API</h1>
            <p class="api-intro">NetSage æä¾›å¼ºå¤§çš„ç½‘é¡µå†…å®¹è·å–ã€æ™ºèƒ½æ€»ç»“å’Œç½‘ç»œæ£€ç´¢APIï¼Œæ”¯æŒé«˜å¹¶å‘ã€ä½å»¶è¿Ÿçš„æ•°æ®è·å–ä¸æœç´¢éœ€æ±‚ã€‚</p>
        </section>

        <section id="authentication" class="doc-section">
            <h2>è®¤è¯</h2>
            <div class="content-block">
                <p>æ‰€æœ‰APIè¯·æ±‚éƒ½éœ€è¦ä½¿ç”¨APIå¯†é’¥è¿›è¡Œè®¤è¯ã€‚æ‚¨å¯ä»¥åœ¨<a href="/dashboard">æ§åˆ¶å°</a>ä¸­ç®¡ç†æ‚¨çš„APIå¯†é’¥ã€‚</p>
                <div class="info-box">
                    <div class="info-icon">â„¹ï¸</div>
                    <div class="info-content">
                        è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„APIå¯†é’¥ï¼Œä¸è¦åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­æ˜æ–‡å­˜å‚¨æˆ–åˆ†äº«ç»™ä»–äººã€‚
                    </div>
                </div>
            </div>
        </section>

        <section id="pricing" class="doc-section">
            <h2>è®¡è´¹è¯´æ˜</h2>
            <div class="content-block">
                <p>NetSage é‡‡ç”¨å·®å¼‚åŒ–è®¡è´¹æ¨¡å¼ï¼Œä¸åŒæœåŠ¡ç±»å‹æ¶ˆè€—ä¸åŒçš„ä½¿ç”¨æ¬¡æ•°ï¼š</p>
                
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>æœåŠ¡ç±»å‹</th>
                            <th>APIç«¯ç‚¹</th>
                            <th>è°ƒç”¨1æ¬¡æ¶ˆè€—</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>search</td>
                            <td>/api/v1/plgi/search</td>
                            <td>1æ¬¡ä½¿ç”¨æ¬¡æ•°</td>
                            <td>åŸºç¡€æœç´¢æœåŠ¡</td>
                        </tr>
                        <tr>
                            <td>crawl</td>
                            <td>/api/v1/plgi/crawl</td>
                            <td>2æ¬¡ä½¿ç”¨æ¬¡æ•°</td>
                            <td>ç½‘é¡µå†…å®¹è·å–æœåŠ¡</td>
                        </tr>
                        <tr>
                            <td>search-crawl</td>
                            <td>/api/v1/plgi/search-crawl</td>
                            <td>3æ¬¡ä½¿ç”¨æ¬¡æ•°</td>
                            <td>æ™ºèƒ½çˆ¬å–æœåŠ¡</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box beta-notice">
                    <div class="info-icon">ğŸ†“</div>
                    <div class="info-content">
                        <strong>å…¬æµ‹é˜¶æ®µè¯´æ˜ï¼š</strong><br>
                        ç›®å‰å¤„äºå…¬æµ‹é˜¶æ®µï¼Œæ‰€æœ‰æœåŠ¡å…è´¹æä¾›ã€‚æ–°ç”¨æˆ·é¦–æ¬¡ç™»å½•è‡ªåŠ¨è·å¾—ä¸€ä¸ªå…è´¹API Keyï¼ˆ30å¤©æœ‰æ•ˆæœŸï¼Œ2000æ¬¡ä½¿ç”¨é¢åº¦ï¼‰ã€‚
                    </div>
                </div>
            </div>
        </section>

        <section id="fetch-api" class="doc-section">
            <h2>ç½‘é¡µå†…å®¹è·å– API</h2>
            
            <div class="content-block">
                <h3>è¯·æ±‚åœ°å€</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="method">POST</span>
                        <span class="endpoint">/api/v1/plgi/crawl</span>
                    </div>
                    <pre><code>http://service.netsage.click:3738/api/v1/plgi/crawl</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å¤´</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>åç§°</th>
                            <th>å¿…å¡«</th>
                            <th>æè¿°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Content-Type</td>
                            <td>æ˜¯</td>
                            <td>application/json</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>å¿…å¡«</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>url</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>éœ€è¦çˆ¬å–çš„ç›®æ ‡ç½‘é¡µURL</td>
                        </tr>
                        <tr>
                            <td>fetch_engine</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>
                                çˆ¬å–å¼•æ“ç±»å‹ï¼Œå¯é€‰å€¼ï¼š<br>
                                - pl_chromeï¼šChromeå¼•æ“ï¼ˆæ¨èï¼‰<br>
                                - seleniumï¼šSeleniumå¼•æ“<br>
                                - pl_chrome_docï¼šChromeæ–‡æ¡£å¼•æ“
                            </td>
                        </tr>
                        <tr>
                            <td>parser</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>
                                æ€»ç»“è§£é‡Šå™¨ç‰ˆæœ¬ï¼Œå¯é€‰å€¼ï¼š<br>
                                - sum_v2ï¼šæ€»ç»“è§£é‡Šå™¨v2ç‰ˆæœ¬<br>
                                - sumï¼šæ€»ç»“è§£é‡Šå™¨v1ç‰ˆæœ¬
                            </td>
                        </tr>
                        <tr>
                            <td>params</td>
                            <td>object</td>
                            <td>å¦</td>
                            <td>
                                å¯é€‰å‚æ•°é…ç½®å¯¹è±¡ï¼Œå¯åŒ…å«ï¼š<br>
                                - rerankerï¼šæ˜¯å¦å¯ç”¨é‡æ’å¼•æ“ï¼ˆbooleanï¼‰
                            </td>
                        </tr>
                        <tr>
                            <td>key</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>ç”¨æˆ·çš„APIå¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>å“åº”å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>status</td>
                            <td>integer</td>
                            <td>çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ</td>
                        </tr>
                        <tr>
                            <td>msg</td>
                            <td>string</td>
                            <td>å“åº”æ¶ˆæ¯</td>
                        </tr>
                        <tr>
                            <td>data.times</td>
                            <td>float</td>
                            <td>APIæ€»å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰</td>
                        </tr>
                        <tr>
                            <td>data.results.status.status</td>
                            <td>string</td>
                            <td>çˆ¬å–çŠ¶æ€</td>
                        </tr>
                        <tr>
                            <td>data.results.response.md</td>
                            <td>string</td>
                            <td>ç”Ÿæˆçš„Markdownæ ¼å¼å†…å®¹</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹è¯·æ±‚</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>CURL</span>
                    </div>
                    <pre><code>curl --location 'http://service.netsage.click:3738/api/v1/plgi/crawl' \
--header 'Content-Type: application/json' \
--data '{
    "url": "http://yahoo.js.cn/html/202011/1369.html",
    "fetch_engine": "pl_chrome",
    "parser": "sum_v2",
    "params": {
        "reranker": false
    },
    "key": "YOUR_API_KEY_HERE"
}'</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹å“åº”</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>JSON</span>
                    </div>
                    <pre><code>{
    "status": 200,
    "msg": "success",
    "data": {
        "times": 1.5682954788208008,
        "results": {
            "status": {
                "status": "success",
                "msg": "",
                "final_use_fetcher": "http",
                "http_err": null
            },
            "response": {
                "length": 1082,
                "md": "- +1\n\n# èŸ‹èŸ€çš„é¸£å«å£°æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ\n\n[...çœç•¥å†…å®¹...]"
            }
        }
    }
}</code></pre>
                </div>
            </div>
        </section>

        <section id="search-api" class="doc-section">
            <h2>ç½‘ç»œæ£€ç´¢ API</h2>
            
            <div class="content-block">
                <h3>è¯·æ±‚åœ°å€</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="method">POST</span>
                        <span class="endpoint">/api/v1/plgi/search</span>
                    </div>
                    <pre><code>http://service.netsage.click:3738/api/v1/plgi/search</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å¤´</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>åç§°</th>
                            <th>å¿…å¡«</th>
                            <th>æè¿°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Content-Type</td>
                            <td>æ˜¯</td>
                            <td>application/json</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>å¿…å¡«</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>query</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>æœç´¢æŸ¥è¯¢è¯ï¼Œæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡</td>
                        </tr>
                        <tr>
                            <td>count</td>
                            <td>integer</td>
                            <td>å¦</td>
                            <td>è¿”å›ç»“æœæ•°é‡ï¼Œé»˜è®¤ä¸º3ï¼Œæœ€å¤§ä¸º10</td>
                        </tr>
                        <tr>
                            <td>search_engine</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>
                                æœç´¢å¼•æ“ç±»å‹ï¼Œå¯é€‰å€¼ï¼š<br>
                                - baiduï¼šç™¾åº¦æœç´¢ï¼ˆæ¨èï¼‰<br>
                                - tagvilyï¼šTagvilyæœç´¢<br>
                                - exaï¼šExaæœç´¢
                            </td>
                        </tr>
                        <tr>
                            <td>params</td>
                            <td>object</td>
                            <td>å¦</td>
                            <td>
                                æœç´¢å‚æ•°ï¼Œå¯é€‰é…ç½®ï¼š<br>
                                - mktï¼šå¸‚åœºåœ°åŒºä»£ç ï¼ˆå¦‚ï¼šzh-CN, en-USï¼‰<br>
                                - safeï¼šå®‰å…¨æœç´¢çº§åˆ«
                            </td>
                        </tr>
                        <tr>
                            <td>key</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>ç”¨æˆ·çš„APIå¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>å“åº”å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>status</td>
                            <td>integer</td>
                            <td>çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ</td>
                        </tr>
                        <tr>
                            <td>msg</td>
                            <td>string</td>
                            <td>å“åº”æ¶ˆæ¯</td>
                        </tr>
                        <tr>
                            <td>data.times</td>
                            <td>float</td>
                            <td>APIæ€»å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰</td>
                        </tr>
                        <tr>
                            <td>data.results[]</td>
                            <td>array</td>
                            <td>æœç´¢ç»“æœæ•°ç»„</td>
                        </tr>
                        <tr>
                            <td>data.results[].siteName</td>
                            <td>string</td>
                            <td>ç»“æœé¡µé¢æ ‡é¢˜</td>
                        </tr>
                        <tr>
                            <td>data.results[].snippet</td>
                            <td>string</td>
                            <td>ç»“æœæ‘˜è¦æ–‡æœ¬</td>
                        </tr>
                        <tr>
                            <td>data.results[].url</td>
                            <td>string</td>
                            <td>ç»“æœé¡µé¢URL</td>
                        </tr>
                        <tr>
                            <td>data.results[].content</td>
                            <td>string</td>
                            <td>é¡µé¢å†…å®¹ï¼ˆé€šå¸¸ä¸º"NA"ï¼‰</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹è¯·æ±‚</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>CURL</span>
                    </div>
                    <pre><code>curl --location 'http://service.netsage.click:3738/api/v1/plgi/search' \
--header 'Content-Type: application/json' \
--data '{
    "query": "å¦‚ä½•åŸ¹å…»è‰¯å¥½çš„ç¡çœ ä¹ æƒ¯",
    "count": 2,
    "search_engine": "baidu",
    "params": {
        "mkt": "zh-CN"
    },
    "key": "YOUR_API_KEY_HERE"
}'</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹å“åº”</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>JSON</span>
                    </div>
                    <pre><code>{
    "status": 200,
    "msg": "success.",
    "data": {
        "times": 1.2122457027435303,
        "results": [
            {
                "siteName": "å¦‚ä½•åŸ¹å…»è‰¯å¥½çš„ç¡çœ ä¹ æƒ¯ï¼Ÿä¸“å®¶ç»™å‡º5ä¸ªå®ç”¨å»ºè®®",
                "snippet": "è‰¯å¥½çš„ç¡çœ ä¹ æƒ¯å¯¹èº«ä½“å¥åº·è‡³å…³é‡è¦ï¼Œä¸“å®¶å»ºè®®ä¿æŒè§„å¾‹çš„ä½œæ¯æ—¶é—´...",
                "url": "https://example.com/health/sleep-habits",
                "content": "NA"
            },
            {
                "siteName": "æ”¹å–„ç¡çœ è´¨é‡çš„10ä¸ªç§‘å­¦æ–¹æ³•",
                "snippet": "ç§‘å­¦ç ”ç©¶è¡¨æ˜ï¼Œè‰¯å¥½çš„ç¡çœ ç¯å¢ƒã€æ”¾æ¾æŠ€å·§å’Œå¥åº·çš„ç”Ÿæ´»æ–¹å¼...",
                "url": "https://example.com/wellness/sleep-improvement",
                "content": "NA"
            }
        ]
    }
}</code></pre>
                </div>
            </div>
        </section>

        <section id="crawl-api" class="doc-section">
            <h2>æ™ºèƒ½çˆ¬å–æœç´¢ API</h2>
            
            <div class="content-block">
                <h3>è¯·æ±‚åœ°å€</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="method">POST</span>
                        <span class="endpoint">/api/v1/plgi/search-crawl</span>
                    </div>
                    <pre><code>http://service.netsage.click:3738/api/v1/plgi/search-crawl</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å¤´</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>åç§°</th>
                            <th>å¿…å¡«</th>
                            <th>æè¿°</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Content-Type</td>
                            <td>æ˜¯</td>
                            <td>application/json</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>è¯·æ±‚å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>å¿…å¡«</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>query</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>æœç´¢æŸ¥è¯¢è¯ï¼Œæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡</td>
                        </tr>
                        <tr>
                            <td>count</td>
                            <td>integer</td>
                            <td>å¦</td>
                            <td>è¿”å›ç»“æœæ•°é‡ï¼Œé»˜è®¤ä¸º1ï¼Œæœ€å¤§ä¸º10</td>
                        </tr>
                        <tr>
                            <td>search_engine</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>
                                æœç´¢å¼•æ“ç±»å‹ï¼Œå¯é€‰å€¼ï¼š<br>
                                - baiduï¼šç™¾åº¦æœç´¢ï¼ˆæ¨èï¼‰<br>
                                - tagvilyï¼šTagvilyæœç´¢<br>
                                - exaï¼šExaæœç´¢
                            </td>
                        </tr>
                        <tr>
                            <td>fetch_engine</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>
                                çˆ¬å–å¼•æ“ç±»å‹ï¼Œå¯é€‰å€¼ï¼š<br>
                                - pl_chromeï¼šChromeå¼•æ“<br>
                                - seleniumï¼šSeleniumå¼•æ“<br>
                                - pl_chrome_docï¼šChromeæ–‡æ¡£å¼•æ“
                            </td>
                        </tr>
                        <tr>
                            <td>params</td>
                            <td>object</td>
                            <td>å¦</td>
                            <td>
                                æœç´¢å‚æ•°ï¼Œå¯é€‰é…ç½®ï¼š<br>
                                - mktï¼šå¸‚åœºåœ°åŒºä»£ç ï¼ˆå¦‚ï¼šzh-CN, en-USï¼‰<br>
                                - safeï¼šå®‰å…¨æœç´¢çº§åˆ«
                            </td>
                        </tr>
                        <tr>
                            <td>rerank_engine</td>
                            <td>boolean</td>
                            <td>å¦</td>
                            <td>æ˜¯å¦å¯ç”¨é‡æ’å¼•æ“ä¼˜åŒ–ç»“æœæ’åºï¼Œé»˜è®¤ä¸ºfalseï¼ˆæš‚æ—¶ä¸æ”¯æŒï¼‰</td>
                        </tr>
                        <tr>
                            <td>key</td>
                            <td>string</td>
                            <td>æ˜¯</td>
                            <td>ç”¨æˆ·çš„APIå¯†é’¥ï¼Œç”¨äºèº«ä»½éªŒè¯</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>å“åº”å‚æ•°</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>å‚æ•°å</th>
                            <th>ç±»å‹</th>
                            <th>è¯´æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>status</td>
                            <td>integer</td>
                            <td>çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ</td>
                        </tr>
                        <tr>
                            <td>msg</td>
                            <td>string</td>
                            <td>å“åº”æ¶ˆæ¯</td>
                        </tr>
                        <tr>
                            <td>data.times</td>
                            <td>float</td>
                            <td>APIæ€»å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰</td>
                        </tr>
                        <tr>
                            <td>data.results[]</td>
                            <td>array</td>
                            <td>æœç´¢å’Œçˆ¬å–ç»“æœæ•°ç»„</td>
                        </tr>
                        <tr>
                            <td>data.results[].url</td>
                            <td>string</td>
                            <td>æœç´¢ç»“æœé¡µé¢URL</td>
                        </tr>
                        <tr>
                            <td>data.results[].title</td>
                            <td>string</td>
                            <td>é¡µé¢æ ‡é¢˜</td>
                        </tr>
                        <tr>
                            <td>data.results[].content</td>
                            <td>string</td>
                            <td>æ™ºèƒ½æå–çš„é¡µé¢æ ¸å¿ƒå†…å®¹</td>
                        </tr>
                        <tr>
                            <td>data.results[].status</td>
                            <td>string</td>
                            <td>çˆ¬å–çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹è¯·æ±‚</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>CURL</span>
                    </div>
                    <pre><code>curl --location 'http://service.netsage.click:3738/api/v1/plgi/search-crawl' \
--header 'Content-Type: application/json' \
--data '{
    "query": "æµ·æ´‹ç”Ÿç‰©çš„ç¥ç§˜ä¸–ç•Œ",
    "count": 2,
    "search_engine": "baidu",
    "key": "YOUR_API_KEY_HERE"
}'</code></pre>
                </div>
            </div>

            <div class="content-block">
                <h3>ç¤ºä¾‹å“åº”</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>JSON</span>
                    </div>
                    <pre><code>{
    "status": 200,
    "msg": "success",
    "data": {
        "times": 3.2451920509338379,
        "results": [
            {
                "url": "https://example.com/tech/quantum-computing",
                "title": "æ¤ç‰©ç”Ÿé•¿çš„æœ€ä½³ç¯å¢ƒæ¡ä»¶",
                "content": "æ¤ç‰©ç”Ÿé•¿çš„æœ€ä½³ç¯å¢ƒæ¡ä»¶æ˜¯...",
                "status": "success"
            }
        ]
    }
}</code></pre>
                </div>
            </div>
        </section>

        <section id="playground" class="doc-section">
            <h2>åœ¨çº¿æµ‹è¯•</h2>
            <div class="content-block">
                <div class="api-selector">
                    <div class="selector-group">
                        <label class="selector-label">é€‰æ‹©APIç±»å‹</label>
                        <div class="selector-buttons">
                            <button class="selector-btn active" onclick="switchAPI('fetch')">ç½‘é¡µå†…å®¹è·å–</button>
                            <button class="selector-btn" onclick="switchAPI('search')">ç½‘ç»œæ£€ç´¢</button>
                            <button class="selector-btn" onclick="switchAPI('crawl')">æ™ºèƒ½çˆ¬å–æœç´¢</button>
                        </div>
                    </div>
                </div>
                
                <div class="api-tester">
                    <!-- ç½‘é¡µå†…å®¹è·å–æµ‹è¯•è¡¨å• -->
                    <div id="fetch-tester" class="test-form">
                        <div class="form-group">
                            <label for="fetch-url">ç›®æ ‡URL</label>
                            <input type="text" id="fetch-url" placeholder="è¾“å…¥éœ€è¦çˆ¬å–çš„ç½‘é¡µURL" class="form-control" value="http://yahoo.js.cn/html/202011/1369.html">
                        </div>
                        <div class="form-group">
                            <label for="fetch-engine">å¼•æ“ç±»å‹</label>
                            <select id="fetch-engine" class="form-control">
                                <option value="pl_chrome">pl_chrome</option>
                                <option value="selenium">selenium</option>
                                <option value="pl_chrome_doc">pl_chrome_doc</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="fetch-parser">è§£é‡Šå™¨ç‰ˆæœ¬</label>
                            <select id="fetch-parser" class="form-control">
                                <option value="sum_v2">sum_v2ï¼ˆæ¨èï¼‰</option>
                                <option value="sum">sum</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="fetch-key">APIå¯†é’¥</label>
                            {% if session.get('access_token') %}
                                <input type="text" id="fetch-key" placeholder="è¾“å…¥æ‚¨çš„APIå¯†é’¥" class="form-control" value="">
                                <div class="api-key-hint">
                                    <span class="hint-icon">ğŸ’¡</span>
                                    <span>è¯·å‰å¾€<a href="{{ url_for('dashboard') }}">æ§åˆ¶å°</a>è·å–æ‚¨çš„APIå¯†é’¥</span>
                                </div>
                            {% else %}
                                <input type="text" id="fetch-key" placeholder="è¯·å…ˆç™»å½•è·å–APIå¯†é’¥" class="form-control" value="" disabled>
                                <div class="login-required">
                                    <span class="warning-icon">âš ï¸</span>
                                    <span>éœ€è¦<a href="{{ url_for('login') }}">ç™»å½•</a>åæ‰èƒ½ä½¿ç”¨åœ¨çº¿æµ‹è¯•åŠŸèƒ½</span>
                                </div>
                            {% endif %}
                        </div>
                        {% if session.get('access_token') %}
                            <button onclick="testFetchAPI()" class="btn btn-primary">å‘é€è¯·æ±‚</button>
                        {% else %}
                            <button class="btn btn-primary disabled" disabled>è¯·å…ˆç™»å½•</button>
                        {% endif %}
                    </div>
                    
                    <!-- ç½‘ç»œæ£€ç´¢æµ‹è¯•è¡¨å• -->
                    <div id="search-tester" class="test-form" style="display: none;">
                        <div class="form-group">
                            <label for="search-query">æœç´¢æŸ¥è¯¢</label>
                            <input type="text" id="search-query" placeholder="è¾“å…¥æœç´¢å…³é”®è¯" class="form-control" value="æµ·æ´‹ç”Ÿç‰©çš„ç¥ç§˜ä¸–ç•Œ">
                        </div>
                        <div class="form-group">
                            <label for="search-count">ç»“æœæ•°é‡</label>
                            <select id="search-count" class="form-control">
                                <option value="1">1æ¡</option>
                                <option value="2" selected>2æ¡</option>
                                <option value="3">3æ¡</option>
                                <option value="5">5æ¡</option>
                                <option value="10">10æ¡</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="search-engine">æœç´¢å¼•æ“</label>
                            <select id="search-engine" class="form-control">
                                <option value="baidu" selected>ç™¾åº¦</option>
                                <option value="tagvily">Tagvily</option>
                                <option value="exa">Exa</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="search-mkt">å¸‚åœºä»£ç </label>
                            <select id="search-mkt" class="form-control">
                                <option value="zh-CN" selected>zh-CN (ä¸­æ–‡ç®€ä½“)</option>
                                <option value="en-US">en-US (è‹±è¯­ç¾å›½)</option>
                                <option value="en-GB">en-GB (è‹±è¯­è‹±å›½)</option>
                                <option value="ja-JP">ja-JP (æ—¥è¯­)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="search-key">APIå¯†é’¥</label>
                            {% if session.get('access_token') %}
                                <input type="text" id="search-key" placeholder="è¾“å…¥æ‚¨çš„APIå¯†é’¥" class="form-control" value="">
                                <div class="api-key-hint">
                                    <span class="hint-icon">ğŸ’¡</span>
                                    <span>è¯·å‰å¾€<a href="{{ url_for('dashboard') }}">æ§åˆ¶å°</a>è·å–æ‚¨çš„APIå¯†é’¥</span>
                                </div>
                            {% else %}
                                <input type="text" id="search-key" placeholder="è¯·å…ˆç™»å½•è·å–APIå¯†é’¥" class="form-control" value="" disabled>
                                <div class="login-required">
                                    <span class="warning-icon">âš ï¸</span>
                                    <span>éœ€è¦<a href="{{ url_for('login') }}">ç™»å½•</a>åæ‰èƒ½ä½¿ç”¨åœ¨çº¿æµ‹è¯•åŠŸèƒ½</span>
                                </div>
                            {% endif %}
                        </div>
                        {% if session.get('access_token') %}
                            <button onclick="testSearchAPI()" class="btn btn-primary">å‘é€è¯·æ±‚</button>
                        {% else %}
                            <button class="btn btn-primary disabled" disabled>è¯·å…ˆç™»å½•</button>
                        {% endif %}
                    </div>
                    
                    <!-- æ™ºèƒ½çˆ¬å–æœç´¢æµ‹è¯•è¡¨å• -->
                    <div id="crawl-tester" class="test-form" style="display: none;">
                        <div class="form-group">
                            <label for="crawl-query">æœç´¢æŸ¥è¯¢</label>
                            <input type="text" id="crawl-query" placeholder="è¾“å…¥æœç´¢å…³é”®è¯" class="form-control" value="é‡å­è®¡ç®—æœºçš„å·¥ä½œåŸç†">
                        </div>
                        <div class="form-group">
                            <label for="crawl-count">ç»“æœæ•°é‡</label>
                            <select id="crawl-count" class="form-control">
                                <option value="1" selected>1æ¡</option>
                                <option value="2">2æ¡</option>
                                <option value="3">3æ¡</option>
                                <option value="5">5æ¡</option>
                                <option value="10">10æ¡</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="crawl-search-engine">æœç´¢å¼•æ“</label>
                            <select id="crawl-search-engine" class="form-control">
                                <option value="baidu" selected>ç™¾åº¦</option>
                                <option value="tagvily">Tagvily</option>
                                <option value="exa">Exa</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="crawl-fetch-engine">çˆ¬å–å¼•æ“</label>
                            <select id="crawl-fetch-engine" class="form-control">
                                <option value="pl_chrome" selected>pl_chrome</option>
                                <option value="selenium">selenium</option>
                                <option value="pl_chrome_doc">pl_chrome_doc</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="crawl-mkt">å¸‚åœºä»£ç </label>
                            <select id="crawl-mkt" class="form-control">
                                <option value="zh-CN" selected>zh-CN (ä¸­æ–‡ç®€ä½“)</option>
                                <option value="en-US">en-US (è‹±è¯­ç¾å›½)</option>
                                <option value="en-GB">en-GB (è‹±è¯­è‹±å›½)</option>
                                <option value="ja-JP">ja-JP (æ—¥è¯­)</option>
                            </select>
                        </div>
                        <div class="form-group" style="display: none;">
                            <label for="crawl-rerank">é‡æ’å¼•æ“</label>
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="crawl-rerank" class="glow-checkbox">
                                <label for="crawl-rerank" class="checkbox-label">å¯ç”¨é‡æ’å¼•æ“</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="crawl-key">APIå¯†é’¥</label>
                            {% if session.get('access_token') %}
                                <input type="text" id="crawl-key" placeholder="è¾“å…¥æ‚¨çš„APIå¯†é’¥" class="form-control" value="">
                                <div class="api-key-hint">
                                    <span class="hint-icon">ğŸ’¡</span>
                                    <span>è¯·å‰å¾€<a href="{{ url_for('dashboard') }}">æ§åˆ¶å°</a>è·å–æ‚¨çš„APIå¯†é’¥</span>
                                </div>
                            {% else %}
                                <input type="text" id="crawl-key" placeholder="è¯·å…ˆç™»å½•è·å–APIå¯†é’¥" class="form-control" value="" disabled>
                                <div class="login-required">
                                    <span class="warning-icon">âš ï¸</span>
                                    <span>éœ€è¦<a href="{{ url_for('login') }}">ç™»å½•</a>åæ‰èƒ½ä½¿ç”¨åœ¨çº¿æµ‹è¯•åŠŸèƒ½</span>
                                </div>
                            {% endif %}
                        </div>
                        {% if session.get('access_token') %}
                            <button onclick="testCrawlAPI()" class="btn btn-primary">å‘é€è¯·æ±‚</button>
                        {% else %}
                            <button class="btn btn-primary disabled" disabled>è¯·å…ˆç™»å½•</button>
                        {% endif %}
                    </div>
                    <div class="test-response">
                        <div class="code-header">
                            <span>å“åº”ç»“æœ</span>
                            <div class="response-time" id="response-time" style="display: none;">
                                <span class="time-label">å“åº”æ—¶é—´:</span>
                                <span class="time-value"></span>
                            </div>
                        </div>
                        <pre><code id="response-data">// å“åº”å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</code></pre>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<style>
.api-docs {
    display: flex;
    min-height: calc(100vh - 60px);
    padding-top: 60px;
    background: var(--bg-primary);
}

.api-sidebar {
    width: 260px;
    background: var(--bg-secondary);
    border-right: 1px solid var(--border);
    position: fixed;
    height: 100vh;
    overflow-y: auto;
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--border);
}

.sidebar-header h3 {
    margin: 0;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    letter-spacing: 1px;
}

.sidebar-nav {
    padding: 1rem 0;
}

.sidebar-nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.sidebar-nav li {
    margin: 0.5rem 0;
}

.sidebar-nav a {
    display: block;
    padding: 0.5rem 1.5rem;
    color: var(--text-muted);
    text-decoration: none;
    font-size: 0.95rem;
    font-family: 'Fira Code', monospace;
    transition: all 0.3s ease;
}

.sidebar-nav a:hover,
.sidebar-nav a.active {
    color: var(--text-primary);
    background: var(--bg-tertiary);
    text-shadow: 0 0 5px var(--text-primary);
}

.nav-group {
    display: block;
    padding: 0.5rem 1.5rem;
    color: var(--text-primary);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-family: 'Fira Code', monospace;
    font-weight: 600;
}

.api-content {
    flex: 1;
    margin-left: 260px;
    padding: 2rem 3rem;
    max-width: 1200px;
    background: var(--bg-primary);
}

.doc-section {
    margin-bottom: 3rem;
}

.doc-section h1 {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    letter-spacing: 2px;
    text-shadow: 0 0 10px var(--text-primary);
}

.doc-section h2 {
    font-size: 1.8rem;
    margin: 2rem 0 1rem;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    letter-spacing: 1px;
}

.api-intro {
    font-size: 1.2rem;
    color: var(--text-muted);
    margin-bottom: 2rem;
    font-family: 'JetBrains Mono', monospace;
}

.content-block {
    margin-bottom: 2rem;
    max-width: 1000px;
}

.content-block h3 {
    font-size: 1.2rem;
    color: var(--text-primary);
    margin-bottom: 1rem;
    text-align: left;
    font-family: 'Fira Code', monospace;
    letter-spacing: 1px;
}

.code-block {
    background: #1e1e1e;
    border: 1px solid #2d2d2d;
    border-radius: 6px;
    overflow: hidden;
    text-align: left;
    max-width: 800px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 1rem;
    background: #2d2d2d;
    border-bottom: 1px solid #3d3d3d;
    color: #e0e0e0;
}

.code-header .method {
    color: #fff;
    background: var(--text-primary);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.85rem;
    font-family: 'Fira Code', monospace;
    font-weight: 600;
}

.code-header .endpoint {
    color: var(--text-muted);
    margin-left: 0.5rem;
    font-family: 'Fira Code', monospace;
}

.copy-btn {
    padding: 0.25rem 0.75rem;
    background: var(--bg-primary);
    color: var(--text-primary);
    border: 1px solid var(--border);
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    font-family: 'Fira Code', monospace;
    transition: all 0.3s ease;
}

.copy-btn:hover {
    background: var(--text-primary);
    color: var(--bg-primary);
    box-shadow: 0 0 10px var(--text-primary);
}

.code-block pre {
    margin: 0;
    padding: 1rem;
    overflow-x: auto;
    background: #1e1e1e;
    text-align: left;
}

.code-block code {
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    color: #e0e0e0;
    display: block;
    text-align: left;
}

.code-block .string { color: #ce9178; }
.code-block .number { color: #b5cea8; }
.code-block .boolean { color: #569cd6; }
.code-block .null { color: #569cd6; }
.code-block .key { color: #9cdcfe; }
.code-block .punctuation { color: #d4d4d4; }

.params-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
    text-align: left;
    max-width: 800px;
    background: var(--bg-secondary);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.params-table th,
.params-table td {
    padding: 0.75rem;
    text-align: left;
    border: 1px solid var(--border);
}

.params-table th {
    background: var(--bg-tertiary);
    font-weight: 600;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 0.9rem;
}

.params-table td {
    color: var(--text-secondary);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9rem;
}

.info-box {
    display: flex;
    align-items: flex-start;
    padding: 1rem;
    background: rgba(0, 255, 65, 0.1);
    border: 1px solid var(--text-primary);
    border-radius: 6px;
    margin: 1rem 0;
}

.info-icon {
    margin-right: 1rem;
    font-size: 1.2rem;
    color: var(--text-primary);
}

.info-content {
    color: var(--text-primary);
    font-size: 0.95rem;
    font-family: 'JetBrains Mono', monospace;
}

.beta-notice {
    background: rgba(255, 215, 0, 0.1) !important;
    border-color: #ffd700 !important;
}

.beta-notice .info-icon {
    color: #ffd700 !important;
    text-shadow: 0 0 10px #ffd700;
}

.beta-notice .info-content {
    color: var(--text-secondary) !important;
}

.beta-notice .info-content strong {
    color: #ffd700;
    text-shadow: 0 0 5px #ffd700;
}

.api-tester {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 1.5rem;
    max-width: 800px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.test-form {
    margin-bottom: 2rem;
    max-width: 800px;
    text-align: left;
}

.form-group {
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    text-align: left;
}

.form-group label {
    width: 100px;
    text-align: left;
    margin-bottom: 0;
    margin-right: 1rem;
    flex-shrink: 0;
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    letter-spacing: 1px;
    text-transform: uppercase;
}

.form-control {
    flex: 1;
    max-width: 600px;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    padding: 0.5rem;
    border-radius: 4px;
    font-family: 'JetBrains Mono', monospace;
    transition: all 0.3s ease;
}

.form-control:focus {
    outline: none;
    border-color: var(--text-primary);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
}

.form-control::placeholder {
    color: var(--text-muted);
}

.btn-primary {
    margin-left: 100px;
    padding: 0.5rem 2rem;
    background: var(--gradient);
    color: var(--bg-primary);
    border: none;
    border-radius: 4px;
    font-family: 'Fira Code', monospace;
    font-weight: 600;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 255, 65, 0.3);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 255, 65, 0.4);
}

.btn-primary.disabled {
    background: var(--bg-tertiary);
    color: var(--text-muted);
    cursor: not-allowed;
    box-shadow: none;
    opacity: 0.6;
}

.btn-primary.disabled:hover {
    transform: none;
    box-shadow: none;
}

.api-key-hint, .login-required {
    margin-top: 0.5rem;
    margin-left: 100px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    color: var(--text-muted);
    font-family: 'Fira Code', monospace;
}

.api-key-hint a, .login-required a {
    color: var(--text-primary);
    text-decoration: none;
    border-bottom: 1px solid var(--text-primary);
    transition: all 0.3s ease;
}

.api-key-hint a:hover, .login-required a:hover {
    color: var(--text-primary);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
}

.hint-icon {
    color: #ffff00;
    text-shadow: 0 0 5px #ffff00;
}

.warning-icon {
    color: var(--accent);
    text-shadow: 0 0 5px var(--accent);
}

.form-control:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    border-color: var(--text-muted);
}

.checkbox-wrapper {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex: 1;
}

.glow-checkbox {
    appearance: none;
    width: 20px;
    height: 20px;
    border: 2px solid #ffd700;
    border-radius: 4px;
    background: var(--bg-primary);
    cursor: pointer;
    position: relative;
    transition: all 0.3s ease;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

.glow-checkbox:hover {
    border-color: #ffed4e;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.glow-checkbox:checked {
    background: #ffd700;
    border-color: #ffed4e;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
}

.glow-checkbox:checked::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--bg-primary);
    font-size: 14px;
    font-weight: bold;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
}

.checkbox-label {
    color: var(--text-secondary);
    font-family: 'Fira Code', monospace;
    font-size: 0.85rem;
    cursor: pointer;
    margin: 0;
    transition: color 0.3s ease;
}

.checkbox-label:hover {
    color: var(--text-primary);
}

.api-selector {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 6px;
    max-width: 800px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.selector-group {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.selector-label {
    color: var(--text-primary);
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    letter-spacing: 1px;
    text-transform: uppercase;
    flex-shrink: 0;
}

.selector-buttons {
    display: flex;
    gap: 0.5rem;
}

.selector-btn {
    padding: 0.5rem 1rem;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    border-radius: 4px;
    font-family: 'Fira Code', monospace;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.selector-btn:hover {
    border-color: var(--text-primary);
    color: var(--text-primary);
}

.selector-btn.active {
    background: var(--gradient);
    color: var(--bg-primary);
    border-color: var(--text-primary);
    box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
}

.test-response {
    background: #1e1e1e;
    border: 1px solid #2d2d2d;
    border-radius: 6px;
    overflow: hidden;
    text-align: left;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.test-response .code-header {
    background: #2d2d2d;
    color: #e0e0e0;
}

.response-time {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.time-label {
    color: var(--text-muted);
    font-size: 0.8rem;
    font-family: 'Fira Code', monospace;
}

.time-value {
    color: #ffff00;
    text-shadow: 0 0 8px #ffff00, 0 0 12px #ffff00;
    font-weight: bold;
    background: rgba(255, 255, 0, 0.1);
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 0, 0.3);
    font-family: 'Fira Code', monospace;
    font-size: 0.85rem;
}

#response-data {
    margin: 0;
    padding: 1rem;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    color: #e0e0e0;
    background: #1e1e1e;
    display: block;
    text-align: left;
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.api-sidebar::-webkit-scrollbar {
    width: 6px;
}

.api-sidebar::-webkit-scrollbar-track {
    background: var(--bg-primary);
}

.api-sidebar::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: 3px;
}

.api-sidebar::-webkit-scrollbar-thumb:hover {
    background: var(--text-primary);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .api-docs {
        flex-direction: column;
    }
    
    .api-sidebar {
        position: relative;
        width: 100%;
        height: auto;
    }
    
    .api-content {
        margin-left: 0;
        padding: 1rem;
    }
    
    .form-group {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .form-group label {
        width: auto;
        margin-bottom: 0.5rem;
        margin-right: 0;
    }
    
    .btn-primary {
        margin-left: 0;
        width: 100%;
    }
    
    .api-key-hint, .login-required {
        margin-left: 0;
    }
}
</style>

<script>
// APIåˆ‡æ¢åŠŸèƒ½
function switchAPI(apiType) {
    // æ›´æ–°æŒ‰é’®çŠ¶æ€
    document.querySelectorAll('.selector-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // åˆ‡æ¢æµ‹è¯•è¡¨å•
    const fetchTester = document.getElementById('fetch-tester');
    const searchTester = document.getElementById('search-tester');
    const crawlTester = document.getElementById('crawl-tester');
    
    if (apiType === 'fetch') {
        fetchTester.style.display = 'block';
        searchTester.style.display = 'none';
        crawlTester.style.display = 'none';
    } else if (apiType === 'search') {
        fetchTester.style.display = 'none';
        searchTester.style.display = 'block';
        crawlTester.style.display = 'none';
    } else if (apiType === 'crawl') {
        fetchTester.style.display = 'none';
        searchTester.style.display = 'none';
        crawlTester.style.display = 'block';
    }
}

// ç½‘é¡µå†…å®¹è·å–APIæµ‹è¯•
async function testFetchAPI() {
    const url = document.getElementById('fetch-url').value;
    const fetch_engine = document.getElementById('fetch-engine').value;
    const parser = document.getElementById('fetch-parser').value;
    const key = document.getElementById('fetch-key').value;
    const responseElement = document.getElementById('response-data');
    const responseTimeElement = document.getElementById('response-time');

    if (!url || !fetch_engine || !parser || !key) {
        responseElement.textContent = 'é”™è¯¯ï¼šè¯·å¡«å†™æ‰€æœ‰å¿…éœ€å‚æ•°';
        responseTimeElement.style.display = 'none';
        return;
    }

    responseElement.textContent = 'æ­£åœ¨å‘é€è¯·æ±‚...';
    responseTimeElement.style.display = 'none';

    try {
        const response = await fetch('/api/proxy/fetch', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                url: url,
                fetch_engine: fetch_engine,
                parser: parser,
                params: {},
                key: key
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        responseElement.innerHTML = formatJSON(data);
        
        // æå–å¹¶æ˜¾ç¤ºå“åº”æ—¶é—´
        if (data.data && data.data.times !== undefined) {
            const timeInMs = Math.round(data.data.times * 1000);
            const timeValueElement = responseTimeElement.querySelector('.time-value');
            timeValueElement.textContent = `${timeInMs} ms`;
            responseTimeElement.style.display = 'flex';
        }
    } catch (error) {
        responseElement.textContent = `é”™è¯¯ï¼š${error.message}\n\nå¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·ç¡®ä¿ï¼š\n1. APIå¯†é’¥æ˜¯æœ‰æ•ˆçš„\n2. ç›®æ ‡URLæ˜¯å¯è®¿é—®çš„\n3. æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ`;
        responseTimeElement.style.display = 'none';
    }
}

// ç½‘ç»œæ£€ç´¢APIæµ‹è¯•
async function testSearchAPI() {
    const query = document.getElementById('search-query').value;
    const count = parseInt(document.getElementById('search-count').value);
    const search_engine = document.getElementById('search-engine').value;
    const mkt = document.getElementById('search-mkt').value;
    const key = document.getElementById('search-key').value;
    const responseElement = document.getElementById('response-data');
    const responseTimeElement = document.getElementById('response-time');

    if (!query || !search_engine || !key) {
        responseElement.textContent = 'é”™è¯¯ï¼šè¯·å¡«å†™æ‰€æœ‰å¿…éœ€å‚æ•°';
        responseTimeElement.style.display = 'none';
        return;
    }

    responseElement.textContent = 'æ­£åœ¨å‘é€è¯·æ±‚...';
    responseTimeElement.style.display = 'none';

    try {
        const startTime = Date.now();
        
        const response = await fetch('/api/proxy/search', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                query: query,
                count: count,
                search_engine: search_engine,
                params: {
                    mkt: mkt
                },
                key: key
            })
        });

        const endTime = Date.now();
        const clientTime = (endTime - startTime) / 1000;

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        responseElement.innerHTML = formatJSON(data);
        
        // æ˜¾ç¤ºå“åº”æ—¶é—´
        if (data.data && data.data.times) {
            responseTimeElement.querySelector('.time-value').textContent = `${data.data.times.toFixed(2)}s`;
            responseTimeElement.style.display = 'flex';
        }
    } catch (error) {
        responseElement.textContent = `é”™è¯¯ï¼š${error.message}\n\nå¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·ç¡®ä¿ï¼š\n1. APIå¯†é’¥æ˜¯æœ‰æ•ˆçš„\n2. æœç´¢æŸ¥è¯¢è¯ä¸ä¸ºç©º\n3. æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ`;
        responseTimeElement.style.display = 'none';
    }
}

// æ™ºèƒ½çˆ¬å–æœç´¢APIæµ‹è¯•
async function testCrawlAPI() {
    const query = document.getElementById('crawl-query').value;
    const count = parseInt(document.getElementById('crawl-count').value);
    const search_engine = document.getElementById('crawl-search-engine').value;
    const fetch_engine = document.getElementById('crawl-fetch-engine').value;
    const mkt = document.getElementById('crawl-mkt').value;
    const rerank_engine = false; // æš‚æ—¶ä¸æ”¯æŒé‡æ’å¼•æ“
    const key = document.getElementById('crawl-key').value;
    const responseElement = document.getElementById('response-data');
    const responseTimeElement = document.getElementById('response-time');

    if (!query || !search_engine || !fetch_engine || !key) {
        responseElement.textContent = 'é”™è¯¯ï¼šè¯·å¡«å†™æ‰€æœ‰å¿…éœ€å‚æ•°';
        responseTimeElement.style.display = 'none';
        return;
    }

    responseElement.textContent = 'æ­£åœ¨å‘é€è¯·æ±‚...';
    responseTimeElement.style.display = 'none';

    try {
        const startTime = Date.now();
        
        const response = await fetch('/api/proxy/crawl', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                query: query,
                count: count,
                search_engine: search_engine,
                params: {
                    mkt: mkt
                },
                key: key,
                rerank_engine: rerank_engine
            })
        });

        const endTime = Date.now();
        const clientTime = (endTime - startTime) / 1000;

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        responseElement.innerHTML = formatJSON(data);
        
        // æ˜¾ç¤ºå“åº”æ—¶é—´
        if (data.data && data.data.times) {
            responseTimeElement.querySelector('.time-value').textContent = `${data.data.times.toFixed(2)}s`;
            responseTimeElement.style.display = 'flex';
        }
    } catch (error) {
        responseElement.textContent = `é”™è¯¯ï¼š${error.message}\n\nå¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·ç¡®ä¿ï¼š\n1. APIå¯†é’¥æ˜¯æœ‰æ•ˆçš„\n2. æœç´¢æŸ¥è¯¢è¯ä¸ä¸ºç©º\n3. ç½‘ç»œè¿æ¥æ­£å¸¸\n4. æœåŠ¡å™¨æ­£å¸¸è¿è¡Œ`;
        responseTimeElement.style.display = 'none';
    }
}

function formatJSON(json) {
    if (typeof json === 'string') {
        try {
            json = JSON.parse(json);
        } catch (e) {
            return json;
        }
    }
    
    const syntaxHighlight = (obj) => {
        let jsonString = JSON.stringify(obj, null, 2);
        jsonString = jsonString.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return jsonString.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, (match) => {
            let cls = 'number';
            if (/^"/.test(match)) {
                if (/:$/.test(match)) {
                    cls = 'key';
                } else {
                    cls = 'string';
                }
            } else if (/true|false/.test(match)) {
                cls = 'boolean';
            } else if (/null/.test(match)) {
                cls = 'null';
            }
            return `<span class="${cls}">${match}</span>`;
        });
    };

    return syntaxHighlight(json);
}

document.addEventListener('DOMContentLoaded', function() {
    const sections = document.querySelectorAll('.doc-section');
    const navLinks = document.querySelectorAll('.sidebar-nav a');

    function setActiveLink() {
        let currentSection = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            if (window.scrollY >= sectionTop - 100) {
                currentSection = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').slice(1) === currentSection) {
                link.classList.add('active');
            }
        });
    }

    window.addEventListener('scroll', setActiveLink);
    setActiveLink();

    const responseExample = document.querySelector('#fetch-api .code-block:last-child code');
    if (responseExample) {
        try {
            const json = JSON.parse(responseExample.textContent);
            responseExample.innerHTML = formatJSON(json);
        } catch (e) {
            console.error('Failed to format example response:', e);
        }
    }
});
</script>
{% endblock %} 